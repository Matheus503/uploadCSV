*&---------------------------------------------------------------------*
*& Include          ZUPLOAD_DADOS_CSV_TOP
*&---------------------------------------------------------------------*
REPORT ZUPLOAD_DADOS_CSV.

TABLES: ZZJ1BNFDOC.

"TIPOS
TYPES:  BEGIN OF TY_TXT,
    DOCNUM            TYPE        J_1BNFDOC-DOCNUM,
    NFTYPE            TYPE        J_1BNFDOC-NFTYPE,
    DOCTYP            TYPE        J_1BNFDOC-DOCTYP,
    DIRECT            TYPE        J_1BNFDOC-DIRECT,
    DOCDAT            TYPE        J_1BNFDOC-DOCDAT,
    PSTDAT            TYPE        J_1BNFDOC-PSTDAT,
    CREDAT            TYPE        J_1BNFDOC-CREDAT,
    CRETIM            TYPE        STRING,
    CRENAM            TYPE        J_1BNFDOC-CRENAM,
    CHADAT            TYPE        J_1BNFDOC-CHADAT,
    CHATIM            TYPE        STRING,
    CHANAM            TYPE        J_1BNFDOC-CHANAM,
    FORM              TYPE        J_1BNFDOC-FORM,
    MODEL             TYPE        J_1BNFDOC-MODEL,
    SERIES            TYPE        J_1BNFDOC-SERIES,
    SUBSER            TYPE        J_1BNFDOC-SUBSER,
    NFNUM             TYPE        J_1BNFDOC-NFNUM,
    ENTRAD            TYPE        J_1BNFDOC-ENTRAD,
    FATURA            TYPE        J_1BNFDOC-FATURA,
    ZTERM             TYPE        J_1BNFDOC-ZTERM,
    PRINTD            TYPE        J_1BNFDOC-PRINTD,
    MANUAL            TYPE        J_1BNFDOC-MANUAL,
    FOLLOW            TYPE        J_1BNFDOC-FOLLOW,
    WAERK             TYPE        J_1BNFDOC-WAERK,
    BELNR             TYPE        J_1BNFDOC-BELNR,
    GJAHR             TYPE        J_1BNFDOC-GJAHR,
    BUKRS             TYPE        J_1BNFDOC-BUKRS,
    BRANCH            TYPE        J_1BNFDOC-BRANCH,
    PARVW             TYPE        J_1BNFDOC-PARVW,
    PARID             TYPE        J_1BNFDOC-PARID,
    PARXCPDK          TYPE        J_1BNFDOC-PARXCPDK,
    PARTYP            TYPE        J_1BNFDOC-PARTYP,
    CANCEL            TYPE        J_1BNFDOC-CANCEL,
    CANDAT            TYPE        J_1BNFDOC-CANDAT,
    SUBSEQ            TYPE        J_1BNFDOC-SUBSEQ,
    DOCREF            TYPE        J_1BNFDOC-DOCREF,
    TRATY             TYPE        J_1BNFDOC-TRATY,
    TRAID             TYPE        J_1BNFDOC-TRAID,
    INCO1             TYPE        J_1BNFDOC-INCO1,
    INCO2             TYPE        J_1BNFDOC-INCO2,
    SHPUNT            TYPE        J_1BNFDOC-SHPUNT,
    ANZPK             TYPE        J_1BNFDOC-ANZPK,
    SHPMRK            TYPE        J_1BNFDOC-SHPMRK,
    SHPNUM            TYPE        J_1BNFDOC-SHPNUM,
    BRGEW             TYPE        STRING,
    NTGEW             TYPE        STRING,
    GEWEI             TYPE        J_1BNFDOC-GEWEI,
    ZFBDT             TYPE        J_1BNFDOC-ZFBDT,
    WITHA             TYPE        STRING,
    OBSERVAT          TYPE        J_1BNFDOC-OBSERVAT,
    VSTEL             TYPE        J_1BNFDOC-VSTEL,
    NFDEC             TYPE        J_1BNFDOC-NFDEC,
    NFTOT             TYPE        STRING,
    AWSYS             TYPE        J_1BNFDOC-AWSYS,
    PREFNO            TYPE        STRING,
    CHECOD            TYPE        J_1BNFDOC-CHECOD,
    NFE               TYPE        J_1BNFDOC-NFE,
    NFENUM            TYPE        J_1BNFDOC-NFENUM,
    NFESRV            TYPE        J_1BNFDOC-NFESRV,
    CONTING           TYPE        J_1BNFDOC-CONTING,
    AUTHCOD           TYPE        J_1BNFDOC-AUTHCOD,
    DOCSTAT           TYPE        J_1BNFDOC-DOCSTAT,
    XMLVERS           TYPE        STRING,
    NFENRNR           TYPE        J_1BNFDOC-NFENRNR,
    CODE              TYPE        J_1BNFDOC-CODE,
    ANRED             TYPE        J_1BNFDOC-ANRED,
    NAME1             TYPE        J_1BNFDOC-NAME1,
    NAME2             TYPE        J_1BNFDOC-NAME2,
    NAME3             TYPE        J_1BNFDOC-NAME3,
    NAME4             TYPE        J_1BNFDOC-NAME4,
    STRAS             TYPE        J_1BNFDOC-STRAS,
    ORT01             TYPE        J_1BNFDOC-ORT01,
    ORT02             TYPE        J_1BNFDOC-ORT02,
    REGIO             TYPE        J_1BNFDOC-REGIO,
    LAND1             TYPE        J_1BNFDOC-LAND1,
    PSTLZ             TYPE        J_1BNFDOC-PSTLZ,
    PFACH             TYPE        J_1BNFDOC-PFACH,
    PSTL2             TYPE        J_1BNFDOC-PSTL2,
    SORTL             TYPE        J_1BNFDOC-SORTL,
    SPRAS             TYPE        J_1BNFDOC-SPRAS,
    TELF1             TYPE        J_1BNFDOC-TELF1,
    TELFX             TYPE        J_1BNFDOC-TELFX,
    TELTX             TYPE        J_1BNFDOC-TELTX,
    TELX1             TYPE        J_1BNFDOC-TELX1,
    INDUST            TYPE        J_1BNFDOC-INDUST,
    STKZN             TYPE        J_1BNFDOC-STKZN,
    CGC               TYPE        C LENGTH 18,
    CPF               TYPE        C LENGTH 14,
    STAINS            TYPE        J_1BNFDOC-STAINS,
    MUNINS            TYPE        J_1BNFDOC-MUNINS,
    TXJCD             TYPE        J_1BNFDOC-TXJCD,
    HAUSN             TYPE        J_1BNFDOC-HAUSN,
    STOCK             TYPE        J_1BNFDOC-STOCK,
    STREET            TYPE        J_1BNFDOC-STREET,
    HOUSE_NUM1        TYPE        J_1BNFDOC-HOUSE_NUM1,
    HOUSE_NUM2        TYPE        J_1BNFDOC-HOUSE_NUM2,
    IND_IEDEST        TYPE        J_1BNFDOC-IND_IEDEST,
    FOREIGNID         TYPE        J_1BNFDOC-FOREIGNID,
    SMTP_ADDR         TYPE        J_1BNFDOC-SMTP_ADDR,
    AUTHDATE          TYPE        J_1BNFDOC-AUTHDATE,
    AUTHTIME          TYPE        STRING,
    BAPI_FLAG         TYPE        J_1BNFDOC-BAPI_FLAG,
    SERV_TP           TYPE        J_1BNFDOC-SERV_TP,
    CTE_STRT_LCT      TYPE        J_1BNFDOC-CTE_STRT_LCT,
    CTE_END_LCT       TYPE        J_1BNFDOC-CTE_END_LCT,
    MAIN_PRODUCT      TYPE        J_1BNFDOC-MAIN_PRODUCT,
    RCVR_WDW          TYPE        J_1BNFDOC-RCVR_WDW,
    PLN_DT_DLV        TYPE        J_1BNFDOC-PLN_DT_DLV,
    FTL_IND           TYPE        J_1BNFDOC-FTL_IND,
    VOL_TRANSP        TYPE        STRING,
    VOL_UNIT          TYPE        J_1BNFDOC-VOL_UNIT,
    TOTAL_REF_AMT     TYPE        STRING,
    TRANSP_MODE       TYPE        J_1BNFDOC-TRANSP_MODE,
    CRE_TIMESTAMP     TYPE        STRING,
    CTE_PARTNER       TYPE        J_1BNFDOC-CTE_PARTNER,
    CTE_SERV_TAKER    TYPE        J_1BNFDOC-CTE_SERV_TAKER,
    CTE_TYPE          TYPE        J_1BNFDOC-CTE_TYPE,
    AUTOM_INCOMING    TYPE        J_1BNFDOC-AUTOM_INCOMING,
    DOCNUM_NEXT       TYPE        J_1BNFDOC-DOCNUM_NEXT,
    DOCNUM_PREV       TYPE        J_1BNFDOC-DOCNUM_PREV,
    MUNICIPAL         TYPE        J_1BNFDOC-MUNICIPAL,
    NATOP             TYPE        J_1BNFDOC-NATOP,
    INDPAG            TYPE        J_1BNFDOC-INDPAG,
    DSAIENT           TYPE        J_1BNFDOC-DSAIENT,
    HSAIENT           TYPE        STRING,
    CNPJ_BUPLA        TYPE        C LENGTH 18,
    IE_BUPLA          TYPE        J_1BNFDOC-IE_BUPLA,
    IEST_BUPLA        TYPE        J_1BNFDOC-IEST_BUPLA,
    IEST_PARTNER      TYPE        J_1BNFDOC-IEST_PARTNER,
    IM_BUPLA          TYPE        J_1BNFDOC-IM_BUPLA,
    CNAE_BUPLA        TYPE        J_1BNFDOC-CNAE_BUPLA,
    CNAE_PARTNER      TYPE        J_1BNFDOC-CNAE_PARTNER,
    CRT_BUPLA         TYPE        J_1BNFDOC-CRT_BUPLA,
    CRT_PARTNER       TYPE        J_1BNFDOC-CRT_PARTNER,
    ISUF              TYPE        J_1BNFDOC-ISUF,
    MODFRETE          TYPE        J_1BNFDOC-MODFRETE,
    PLACA             TYPE        J_1BNFDOC-PLACA,
    UF1               TYPE        J_1BNFDOC-UF1,
    RNTC              TYPE        J_1BNFDOC-RNTC,
    VAGAO             TYPE        J_1BNFDOC-VAGAO,
    BALSA             TYPE        J_1BNFDOC-BALSA,
    NFAT              TYPE        J_1BNFDOC-NFAT,
    VORIG             TYPE        STRING,
    VDESC             TYPE        STRING,
    VLIQ              TYPE        STRING,
    UFEMBARQ          TYPE        J_1BNFDOC-UFEMBARQ,
    XLOCEMBARQ        TYPE        J_1BNFDOC-XLOCEMBARQ,
    XNEMP             TYPE        J_1BNFDOC-XNEMP,
    SPRAS_BUPLA       TYPE        J_1BNFDOC-SPRAS_BUPLA,
    IND_EMIT          TYPE        J_1BNFDOC-IND_EMIT,
    COD_SIT           TYPE        J_1BNFDOC-COD_SIT,
    IND_FINAL         TYPE        J_1BNFDOC-IND_FINAL,
    IND_PRES          TYPE        J_1BNFDOC-IND_PRES,
    XLOCDESPACHO      TYPE        J_1BNFDOC-XLOCDESPACHO,
    DCOMPET           TYPE        J_1BNFDOC-DCOMPET,
    CREGTRIB          TYPE        J_1BNFDOC-CREGTRIB,
    RETTRANSP_CFOP    TYPE        J_1BNFDOC-RETTRANSP_CFOP,
    RETTRANSP_CMUNFG  TYPE        J_1BNFDOC-RETTRANSP_CMUNFG,
    IND_BADI_CTRL     TYPE        J_1BNFDOC-IND_BADI_CTRL,
    ID_DEST           TYPE        J_1BNFDOC-ID_DEST,
    HEMI              TYPE        STRING,
    V_TROCO           TYPE        STRING,
    MOD               TYPE        J_1BNFDOC-MOD,
    NCOO              TYPE        J_1BNFDOC-NCOO,
    INDINTERMED       TYPE        J_1BNFDOC-INDINTERMED,
    IDCADINTTRAN      TYPE        J_1BNFDOC-IDCADINTTRAN,
    CNPJINTERMED      TYPE        C LENGTH 18,
    SAFRA             TYPE        J_1BNFDOC-SAFRA,
    REF_MONTH_YEAR    TYPE        J_1BNFDOC-REF_MONTH_YEAR,
    QTOTMES           TYPE        STRING,
    QTOTANT           TYPE        STRING,
    QTOTGER           TYPE        STRING,
    VFOR              TYPE        STRING,
    VTOTDED           TYPE        STRING,
    VLIQFOR           TYPE        STRING,
    ITMF_REPDAT       TYPE        J_1BNFDOC-ITMF_REPDAT,
    ITMF_PCO_CATEGORY TYPE        J_1BNFDOC-ITMF_PCO_CATEGORY,
    PARTR             TYPE        STRING,
    NFNUM_UTILITIES   TYPE        J_1BNFDOC-NFNUM_UTILITIES,
    PARTNER_ROLE      TYPE        J_1BNFDOC-PARTNER_ROLE,
    COD_CTA_HEADER    TYPE        J_1BNFDOC-COD_CTA_HEADER,
    ZZAUTH_DOC        TYPE        J_1BNFDOC-ZZAUTH_DOC,
    ZZCOD_DIG         TYPE        J_1BNFDOC-ZZCOD_DIG,
    ZZCHECOD          TYPE        J_1BNFDOC-ZZCHECOD,
END OF TY_TXT.

TYPES: BEGIN OF TY_CSV,
  LINE(20000) TYPE C,
END OF TY_CSV.

* TABELAS INTERNAS
DATA: T_TXT    TYPE TABLE OF ZZJ1BNFDOC.
DATA: T_CSV    TYPE TABLE OF TY_CSV.

*WORK AREA
DATA:  LS_TXT TYPE ZZJ1BNFDOC.
DATA:  LS_CSV TYPE TY_CSV.

DATA: gv_answer.
